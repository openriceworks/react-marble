"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.logContext = void 0;
const M = require("fp-ts/lib/Map");
const A = require("fp-ts/lib/Array");
const IO_1 = require("fp-ts/lib/IO");
const pipeable_1 = require("fp-ts/lib/pipeable");
const logger_1 = require("../logger");
const context_1 = require("./context");
const context_hook_1 = require("./context.hook");
const logContext = (tag) => (context) => {
    const logger = (0, pipeable_1.pipe)((0, context_1.lookup)(context), (0, context_hook_1.useContext)(logger_1.LoggerToken));
    const log = (token) => logger({
        tag,
        type: 'Context',
        message: token.name
            ? `Registered: "${token.name}"`
            : `Registered unnamed token: ${token._id}`,
    });
    const logDependencies = A.array.sequence(IO_1.io)((0, pipeable_1.pipe)(context, M.keys(context_1.ordContextToken), A.map(log)));
    logDependencies();
    return context;
};
exports.logContext = logContext;
