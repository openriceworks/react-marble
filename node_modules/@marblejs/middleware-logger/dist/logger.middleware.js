"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.logger$ = void 0;
const core_1 = require("@marblejs/core");
const operators_1 = require("rxjs/operators");
const logger_handler_1 = require("./logger.handler");
const logger$ = (opts = {}) => (req$, ctx) => {
    const logger = (0, core_1.useContext)(core_1.LoggerToken)(ctx.ask);
    return req$.pipe((0, operators_1.timestamp)(), (0, operators_1.tap)(stamp => (0, logger_handler_1.loggerHandler)(opts, logger)(stamp).subscribe()), (0, operators_1.map)(({ value: req }) => req));
};
exports.logger$ = logger$;
