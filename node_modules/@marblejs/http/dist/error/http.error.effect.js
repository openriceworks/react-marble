"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.defaultError$ = void 0;
const operators_1 = require("rxjs/operators");
const http_interface_1 = require("../http.interface");
const http_error_model_1 = require("./http.error.model");
const defaultHttpError = new http_error_model_1.HttpError('Internal server error', http_interface_1.HttpStatus.INTERNAL_SERVER_ERROR);
const getStatusCode = (error) => (0, http_error_model_1.isHttpError)(error)
    ? error.status
    : http_interface_1.HttpStatus.INTERNAL_SERVER_ERROR;
const errorFactory = (status) => (error) => ({
    error: (0, http_error_model_1.isHttpError)(error)
        ? { status, message: error.message, data: error.data, context: error.context }
        : { status, message: error.message },
});
const defaultError$ = req$ => req$.pipe((0, operators_1.map)(({ request, error = defaultHttpError }) => {
    const status = getStatusCode(error);
    const body = errorFactory(status)(error);
    return ({ status, body, request });
}));
exports.defaultError$ = defaultError$;
